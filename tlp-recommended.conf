# TLP推荐配置 - 机械革命耀世16u
# 将此文件复制到 /etc/tlp.d/01-custom.conf 或合并到 /etc/tlp.conf

# ------------------------------------------------------------------------------
# CPU相关设置

# CPU调频器
CPU_SCALING_GOVERNOR_ON_AC=performance
CPU_SCALING_GOVERNOR_ON_BAT=powersave

# Intel P-state性能百分比
# AC: 0-100%, BAT: 0-30% (可根据需求调整，30%已足够日常使用)
CPU_MIN_PERF_ON_AC=0
CPU_MAX_PERF_ON_AC=100
CPU_MIN_PERF_ON_BAT=0
CPU_MAX_PERF_ON_BAT=30

# CPU能耗性能策略（Intel 6代及以上）
CPU_ENERGY_PERF_POLICY_ON_AC=performance
CPU_ENERGY_PERF_POLICY_ON_BAT=power

# CPU Boost开关
CPU_BOOST_ON_AC=1
CPU_BOOST_ON_BAT=0

# 平台配置文件（新型号支持）
PLATFORM_PROFILE_ON_AC=performance
PLATFORM_PROFILE_ON_BAT=low-power

# ------------------------------------------------------------------------------
# 磁盘设备设置

# NVMe/SSD设备列表（根据实际设备修改）
DISK_DEVICES="nvme0n1"

# 高级电源管理级别
# 1-127: 省电激进程度递增, 128: 省电但保持性能, 254: 最高性能
DISK_APM_LEVEL_ON_AC="254 254"
DISK_APM_LEVEL_ON_BAT="128 128"

# NVMe节能级别（APST）
DISK_NVME_APST_ON_AC=off
DISK_NVME_APST_ON_BAT=on

# SATA链接电源管理
SATA_LINKPWR_ON_AC=max_performance
SATA_LINKPWR_ON_BAT=min_power

# ------------------------------------------------------------------------------
# PCIe设置

# PCIe主动状态电源管理
PCIE_ASPM_ON_AC=default
PCIE_ASPM_ON_BAT=powersupersave

# Runtime PM（PCI设备）
RUNTIME_PM_ON_AC=on
RUNTIME_PM_ON_BAT=auto

# ------------------------------------------------------------------------------
# 显卡设置（Intel核显）

# Intel GPU频率（0表示使用默认值）
INTEL_GPU_MIN_FREQ_ON_AC=0
INTEL_GPU_MIN_FREQ_ON_BAT=0
INTEL_GPU_MAX_FREQ_ON_AC=0
INTEL_GPU_MAX_FREQ_ON_BAT=0
INTEL_GPU_BOOST_FREQ_ON_AC=0
INTEL_GPU_BOOST_FREQ_ON_BAT=0

# AMD GPU动态电源管理（如使用AMD显卡，取消注释）
# RADEON_DPM_PERF_LEVEL_ON_AC=auto
# RADEON_DPM_PERF_LEVEL_ON_BAT=low
# RADEON_DPM_STATE_ON_AC=performance
# RADEON_DPM_STATE_ON_BAT=battery

# ------------------------------------------------------------------------------
# 无线设备设置

# WiFi省电模式
WIFI_PWR_ON_AC=off
WIFI_PWR_ON_BAT=on

# 启动时启用/禁用的设备
DEVICES_TO_DISABLE_ON_STARTUP=""
DEVICES_TO_ENABLE_ON_STARTUP="wifi"

# 电池模式下不使用时禁用的设备
# 如果需要蓝牙，从下面移除"bluetooth"
DEVICES_TO_DISABLE_ON_BAT_NOT_IN_USE="bluetooth"

# 关闭无线电设备（蓝牙/WiFi）- 慎用
# DEVICES_TO_DISABLE_ON_LAN_CONNECT="wifi wwan"
# DEVICES_TO_DISABLE_ON_WIFI_CONNECT="wwan"

# ------------------------------------------------------------------------------
# 音频设置

# 音频省电超时（秒）
SOUND_POWER_SAVE_ON_AC=0
SOUND_POWER_SAVE_ON_BAT=1

# 音频控制器省电
SOUND_POWER_SAVE_CONTROLLER=Y

# ------------------------------------------------------------------------------
# USB设备设置

# USB自动挂起模式
USB_AUTOSUSPEND=1

# 排除的USB设备（添加设备ID，格式：1234:5678）
# 使用 lsusb 查找设备ID，例如："1234:5678 5678:9abc"
# USB_DENYLIST="1234:5678"

# 注意：以下USB_BLACKLIST_*参数用于排除整个设备类别
# 而USB_DENYLIST用于排除特定设备ID

# 电话/移动设备充电
USB_BLACKLIST_PHONE=1

# 蓝牙设备（如果需要保持连接）
# USB_BLACKLIST_BTUSB=1

# 打印机
# USB_BLACKLIST_PRINTER=1

# WWAN设备
# USB_BLACKLIST_WWAN=1

# ------------------------------------------------------------------------------
# 电池保养（限制充电阈值，部分笔记本支持）

# 开始充电阈值（电量低于此值时开始充电）
# START_CHARGE_THRESH_BAT0=75
# START_CHARGE_THRESH_BAT1=75

# 停止充电阈值（电量达到此值时停止充电）
# STOP_CHARGE_THRESH_BAT0=80
# STOP_CHARGE_THRESH_BAT1=80

# 恢复充电阈值（电量低于此值时恢复充电）
# RESTORE_THRESHOLDS_ON_BAT=1

# ------------------------------------------------------------------------------
# 其他设置

# 笔记本模式
# 0: 禁用
# 2: 电池供电时启用
DISK_IDLE_SECS_ON_AC=0
DISK_IDLE_SECS_ON_BAT=2

# 最大丢失工作时间（秒）
MAX_LOST_WORK_SECS_ON_AC=15
MAX_LOST_WORK_SECS_ON_BAT=60

# 脏数据刷新超时（毫秒）
DISK_WRITEBACK_TIMEOUT_ON_AC=0
DISK_WRITEBACK_TIMEOUT_ON_BAT=60000

# 网卡节能
ETHERNET_ADAPTER_ON_AC=on
ETHERNET_ADAPTER_ON_BAT=off

# ------------------------------------------------------------------------------
# 说明：
# 
# 1. 复制此文件到系统配置目录：
#    sudo cp tlp-recommended.conf /etc/tlp.d/01-custom.conf
#    或
#    sudo nano /etc/tlp.conf  (然后复制相关内容)
#
# 2. 应用配置：
#    sudo tlp start
#
# 3. 查看TLP状态：
#    sudo tlp-stat -s
#
# 4. 查看完整配置：
#    sudo tlp-stat -c
#
# 5. 监控电池：
#    sudo tlp-stat -b
#
# 注意：根据实际使用情况调整CPU_MAX_PERF_ON_BAT和其他参数
